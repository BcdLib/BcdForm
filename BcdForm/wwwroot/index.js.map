{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/ts/core/base.ts","src/ts/dragHelper.ts","src/ts/global.ts","src/ts/index.ts","src/ts/interop.ts"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","throttle","fn","threshold","timeout","start","Date","_this","this","args","_i","arguments","curTime","window","clearTimeout","apply","setTimeout","getDom","selector","Element","document","querySelector","attr","key","value","dom","setAttribute","getAttribute","addCls","className","element","classList","add","_a","removeCls","clsName","remove","css","name","style","setProperty","cssAttributes","split","cssAttribute","attribute","hasOwnProperty","$","default","global_1","base_1","eventMap","Map","defaultOptions","inViewport","Dragger","prototype","getContainerPos","rect","_container","getBoundingClientRect","left","top","bindDrag","trigger","_trigger","options","_options","addEventListener","onMousedown","onMouseup","onMousemove","onResize","unbindDrag","removeEventListener","resetContainerStyle","_style","_isFirst","container","dragInViewport","_state","stopPropagation","autoDebug","console","log","state","isInDrag","mX","clientX","mY","clientY","position","domMaxY","documentElement","clientHeight","offsetHeight","domMaxX","clientWidth","offsetWidth","domStartX","domStartY","newDomX","nowX","nowY","disX","disY","newDomY","margin","paddingBottom","bind","parseInt","Object","assign","enableDraggable","triggerEle","dragger","get","set","disableDraggable","resetDraggableElePosition","invoke","sessionStorage","getItem","interop","__importStar","bcd","version","dragHelper_1","defineProperty","enumerable","minResetStyle","formRoot","lastIsNormal","rootEle","lastNormalStyle","form","right","maxResetStyle","oldBodyCacheStack","disableBodyScroll","overflow","body","oldBodyCache","forEach","push","width","scrollHeight","innerHeight","enableBodyScroll","pop","_b","_c"],"mappings":"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","file":"index.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","﻿\r\nconst throttle = (fn: Function, threshold = 160) => {\r\n    let timeout;\r\n    var start = +new Date;\r\n    return function (...args) {\r\n        //@ts-ignore\r\n        let context = this, curTime = +new Date() - 0;\r\n        //总是干掉事件回调\r\n        window.clearTimeout(timeout);\r\n        if (curTime - start >= threshold) {\r\n            //只执行一部分方法，这些方法是在某个时间段内执行一次\r\n            fn.apply(context, args);\r\n            start = curTime;\r\n        }\r\n        else {\r\n            //让方法在脱离事件后也能执行一次\r\n            timeout = window.setTimeout(() => {\r\n                //@ts-ignore\r\n                fn.apply(this, args);\r\n            }, threshold);\r\n        }\r\n    };\r\n}\r\n\r\nconst getDom = (selector: string | Element): null | HTMLElement => {\r\n    if (!selector) {\r\n        return null;\r\n    }\r\n    if (selector instanceof Element) {\r\n        return selector as HTMLElement;\r\n    }\r\n\r\n    return document.querySelector(selector) as HTMLElement;\r\n}\r\n\r\nconst attr = (selector: string | Element, key: string, value: string | null = null) => {\r\n    let dom = getDom(selector);\r\n    if (dom) {\r\n        if (value) {\r\n            dom.setAttribute(key, value);\r\n            return value;\r\n        } else {\r\n            return dom.getAttribute(key);\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nconst addCls = (selector: Element | string, className: string | Array<string>) => {\r\n    let element = getDom(selector);\r\n    if (element) {\r\n        if (typeof className === \"string\") {\r\n            element.classList.add(className);\r\n        } else {\r\n            element.classList.add(...className);\r\n        }\r\n    }\r\n}\r\n\r\nconst removeCls = (selector: Element | string, clsName: string | Array<string>) => {\r\n    let element = getDom(selector);\r\n    if (element) {\r\n        if (typeof clsName === \"string\") {\r\n            element.classList.remove(clsName);\r\n        } else {\r\n            element.classList.remove(...clsName);\r\n        }\r\n    }\r\n}\r\n\r\nconst css = (element: HTMLElement, name: string | object, value: string | null = null) => {\r\n    if (typeof name === 'string') {\r\n        if (value === null) {\r\n            let style = name;\r\n            let cssAttributes = style.split(\";\");\r\n            for (let i = 0; i < cssAttributes.length; i++) {\r\n                let cssAttribute = cssAttributes[i];\r\n                if (!cssAttribute) continue;\r\n                let attribute = cssAttribute.split(\":\");\r\n                element.style.setProperty(attribute[0], attribute[1]);\r\n            }\r\n            return;\r\n        }\r\n        element.style.setProperty(name, value);\r\n    } else {\r\n        for (let key in name) {\r\n            if (name.hasOwnProperty(key)) {\r\n                element.style.setProperty(key, name[key]);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nconst $ = getDom;\r\n\r\nexport default $;\r\nexport {\r\n    throttle, getDom, $, attr, addCls, removeCls, css\r\n};","﻿\r\nimport { autoDebug } from \"./global\";\r\nimport { throttle, getDom } from \"./core/base\";\r\n\r\nconst eventMap = new Map<HTMLElement, Dragger>();\r\n\r\nconst defaultOptions = {\r\n    inViewport: true\r\n}\r\n\r\nclass Dragger {\r\n\r\n    private _trigger: HTMLElement;\r\n    private _container: HTMLElement;\r\n    private _options: any = null;\r\n    private _state: any = null;\r\n    private _isFirst: boolean = true;\r\n    private _style: string | null = null;\r\n\r\n    constructor(trigger: HTMLElement, container: HTMLElement, dragInViewport: boolean) {\r\n        this._trigger = trigger;\r\n        this._container = container;\r\n        this._options = Object.assign({}, defaultOptions, {\r\n            inViewport: dragInViewport\r\n        });\r\n        this._state = {\r\n            isInDrag: false,\r\n            mX: 0, // mouse x\r\n            mY: 0, // mouse y\r\n            domStartX: 0, // on mousedown, the mouse x\r\n            domStartY: 0, // on mousedown, the mouse y            \r\n        }\r\n    }\r\n\r\n    getContainerPos() {\r\n        const rect = this._container.getBoundingClientRect();\r\n        return {\r\n            left: rect.left,\r\n            top: rect.top\r\n        }\r\n    }\r\n\r\n    onMousedown = (e) => {\r\n        e.stopPropagation = true;\r\n\r\n        autoDebug(() => {\r\n            console.log(\"onMousedown\");\r\n        });\r\n        const state = this._state;\r\n        state.isInDrag = true;\r\n        state.mX = e.clientX;\r\n        state.mY = e.clientY;\r\n        const { left, top } = this.getContainerPos();\r\n        this._container.style.position = \"absolute\";\r\n\r\n        autoDebug(() => {\r\n            console.log(\"this._isFirst\", this._isFirst, left, top);\r\n        });\r\n\r\n        state.domMaxY = document.documentElement.clientHeight\r\n            - this._container.offsetHeight - 1;\r\n        state.domMaxX = document.documentElement.clientWidth\r\n            - this._container.offsetWidth - 1;\r\n        state.domMaxY = state.domMaxY < 0 ? 0 : state.domMaxY;\r\n        state.domMaxX = state.domMaxX < 0 ? 0 : state.domMaxX;\r\n\r\n\r\n        if (this._isFirst) {\r\n            this._container.style.left = left + 'px';\r\n            this._container.style.top = top + 'px';\r\n\r\n            if (!this._style) {\r\n                this._style = this._container.getAttribute(\"style\");\r\n            }\r\n\r\n            this._isFirst = false;\r\n        }\r\n\r\n        state.domStartX = left;\r\n        state.domStartY = top;\r\n    }\r\n\r\n    onMouseup = (e) => {\r\n        e.stopPropagation = true;\r\n\r\n        const state = this._state;\r\n\r\n        state.isInDrag = false;\r\n\r\n        const { left, top } = this.getContainerPos();\r\n        state.domStartX = left;\r\n        state.domStartY = top;\r\n    }\r\n\r\n    onMousemove = throttle((e) => {\r\n\r\n        const state = this._state;\r\n        if (state.isInDrag) {\r\n            var nowX = e.clientX,\r\n                nowY = e.clientY,\r\n                disX = nowX - state.mX,\r\n                disY = nowY - state.mY;\r\n\r\n            var newDomX = state.domStartX + disX;\r\n            var newDomY = state.domStartY + disY;\r\n            if (this._options.inViewport) {\r\n                if (newDomX < 0) {\r\n                    newDomX = 0;\r\n                }\r\n                else if (newDomX > state.domMaxX) {\r\n                    newDomX = state.domMaxX;\r\n                }\r\n                if (newDomY < 0) {\r\n                    newDomY = 0;\r\n                }\r\n                else if (newDomY > state.domMaxY) {\r\n                    newDomY = state.domMaxY;\r\n                }\r\n            }\r\n            //this._container.style.position = \"absolute\";\r\n            //console.log(\"absolute\");\r\n            this._container.style.margin = \"0\";\r\n            this._container.style.paddingBottom = \"0\";\r\n            this._container.style.left = newDomX + \"px\";\r\n            this._container.style.top = newDomY + \"px\";\r\n        }\r\n    }, 10).bind(this);\r\n\r\n    onResize = throttle((e) => {\r\n        const state = this._state;\r\n\r\n        state.domMaxY = document.documentElement.clientHeight\r\n            - this._container.offsetHeight - 1;\r\n        state.domMaxX = document.documentElement.clientWidth\r\n            - this._container.offsetWidth - 1;\r\n        state.domMaxY = state.domMaxY < 0 ? 0 : state.domMaxY;\r\n        state.domMaxX = state.domMaxX < 0 ? 0 : state.domMaxX;\r\n\r\n        state.domStartY = parseInt(this._container.style.top);\r\n        state.domStartX = parseInt(this._container.style.left);\r\n        if (state.domStartY > state.domMaxY) {\r\n            if (state.domMaxY > 0) {\r\n                this._container.style.top = state.domMaxY + \"px\";\r\n            }\r\n        }\r\n        if (state.domStartX > state.domMaxX) {\r\n            this._container.style.left = state.domMaxX + \"px\";\r\n        }\r\n    }, 10).bind(this);\r\n\r\n    bindDrag() {\r\n        const trigger = this._trigger;\r\n        const options = this._options;\r\n\r\n        trigger.addEventListener(\"mousedown\", this.onMousedown, false);\r\n        window.addEventListener(\"mouseup\", this.onMouseup, false);\r\n        document.addEventListener(\"mousemove\", this.onMousemove);\r\n        if (options.inViewport) {\r\n            window.addEventListener(\"resize\", this.onResize, false);\r\n        }\r\n    }\r\n\r\n    unbindDrag() {\r\n        const trigger = this._trigger;\r\n\r\n        trigger.removeEventListener(\"mousedown\", this.onMousedown, false);\r\n        window.removeEventListener(\"mouseup\", this.onMouseup, false);\r\n        document.removeEventListener(\"mousemove\", this.onMousemove);\r\n        if (this._options.inViewport) {\r\n            window.removeEventListener(\"resize\", this.onResize, false);\r\n        }\r\n    }\r\n\r\n    resetContainerStyle() {\r\n        if (this._style !== null) {\r\n            this._isFirst = true;\r\n            this._container.setAttribute(\"style\", this._style);\r\n        }\r\n    }\r\n}\r\n\r\nfunction enableDraggable(trigger: HTMLElement | string, container: HTMLElement | string, dragInViewport: boolean = true) {\r\n    let triggerEle = getDom(trigger);\r\n    if (triggerEle != null) {\r\n        let dragger = eventMap.get(triggerEle);\r\n        if (!dragger) {\r\n            dragger = new Dragger(triggerEle, getDom(container)!, dragInViewport);\r\n            eventMap.set(triggerEle, dragger);\r\n        }\r\n        dragger.bindDrag();\r\n    }\r\n}\r\n\r\nfunction disableDraggable(trigger: HTMLElement | string) {\r\n    let triggerEle = getDom(trigger);\r\n    if (triggerEle != null) {\r\n        const dragger = eventMap.get(triggerEle);\r\n        if (dragger) {\r\n            dragger.unbindDrag();\r\n        }\r\n    }\r\n}\r\n\r\nfunction resetDraggableElePosition(trigger: HTMLElement | string) {\r\n    let triggerEle = getDom(trigger);\r\n    if (triggerEle != null) {\r\n        const dragger = eventMap.get(triggerEle);\r\n        if (dragger) {\r\n            dragger.resetContainerStyle();\r\n        }\r\n    }\r\n}\r\n\r\nexport { enableDraggable, disableDraggable, resetDraggableElePosition };","﻿\r\nvar autoDebug = (invoke: Function) => {\r\n    var isDebug = sessionStorage.getItem(\"isDebug\") === \"true\";\r\n    if (isDebug) {\r\n        invoke();\r\n    }\r\n}\r\n\r\ndeclare global {\r\n    interface Window {\r\n        bcd: any;\r\n        autoDebug: Function;\r\n    }\r\n}\r\n\r\nexport { autoDebug };\r\n","﻿import { autoDebug } from \"./global\";\r\nimport * as interop from \"./interop\";\r\n\r\n\r\nwindow.bcd = {\r\n    interop,\r\n    version: \"0.0.1\",\r\n    autoDebug: autoDebug\r\n};","﻿export {\r\n    enableDraggable, disableDraggable, resetDraggableElePosition\r\n} from \"./dragHelper\";\r\n\r\nimport { autoDebug } from \"./global\";\r\nimport { getDom, attr, css, addCls, removeCls } from \"./core/base\";\r\n\r\n\r\n/**\r\n * for min to reset drag left and top info\r\n * @param formRoot\r\n */\r\nexport function minResetStyle(formRoot: string | HTMLElement, lastIsNormal:boolean) {\r\n    let rootEle = getDom(formRoot);\r\n    let lastNormalStyle: string | null = \"\";\r\n    if (rootEle) {\r\n        let form = rootEle.querySelector('.bcd-form') as HTMLElement;\r\n        \r\n        if (lastIsNormal) {\r\n            lastNormalStyle = attr(form, \"style\");\r\n\r\n            autoDebug(() => {\r\n                console.log(\"get lastNormalStyle\", lastNormalStyle);\r\n            });\r\n        }\r\n\r\n        autoDebug(() => {\r\n            console.log(\"minResetStyle\");\r\n        });\r\n\r\n        form!.style.left = \"\";\r\n        form!.style.top = \"\";\r\n        form!.style.right = \"\";\r\n    }\r\n    return lastNormalStyle;\r\n}\r\n\r\n\r\n/**\r\n * for min to reset drag left and top info\r\n * @param formRoot\r\n */\r\nexport function maxResetStyle(formRoot: string | HTMLElement, lastIsNormal: boolean) {\r\n    let rootEle = getDom(formRoot);\r\n    let lastNormalStyle: string | null = \"\";\r\n    if (rootEle) {\r\n        let form = rootEle.querySelector('.bcd-form') as HTMLElement;\r\n        if (lastIsNormal) {\r\n            lastNormalStyle = attr(form, \"style\");\r\n\r\n            autoDebug(() => {\r\n                console.log(\"get lastNormalStyle\", lastNormalStyle);\r\n            });\r\n        }\r\n\r\n        autoDebug(() => {\r\n            console.log(\"maxResetStyle\");\r\n        });\r\n\r\n        form!.style.left = \"\";\r\n        form!.style.top = \"\";\r\n    }\r\n    return lastNormalStyle;\r\n}\r\n\r\nlet oldBodyCacheStack: Array<any> = [];\r\n\r\n\r\nconst hasScrollbar = () => {\r\n    let overflow = document.body.style.overflow;\r\n    if (overflow && overflow === \"hidden\") return false;\r\n    return document.body.scrollHeight > (window.innerHeight || document.documentElement.clientHeight);\r\n}\r\n\r\nexport function  disableBodyScroll() {\r\n    let body = document.body;\r\n    const oldBodyCache = {};\r\n    [\"position\", \"width\", \"overflow\"].forEach((key) => {\r\n        oldBodyCache[key] = body.style[key];\r\n    });\r\n    oldBodyCacheStack.push(oldBodyCache);\r\n    css(body,\r\n        {\r\n            \"position\": \"relative\",\r\n            \"width\": hasScrollbar() ? \"calc(100% - 17px)\" : null,\r\n            \"overflow\": \"hidden\"\r\n        });\r\n    addCls(document.body, \"ant-scrolling-effect\");\r\n}\r\n\r\nexport function  enableBodyScroll() {\r\n    let oldBodyCache = oldBodyCacheStack.length > 0 ? oldBodyCacheStack.pop() : {};\r\n\r\n    css(document.body,\r\n        {\r\n            \"position\": oldBodyCache[\"position\"] ?? null,\r\n            \"width\": oldBodyCache[\"width\"] ?? null,\r\n            \"overflow\": oldBodyCache[\"overflow\"] ?? null\r\n        });\r\n    removeCls(document.body, \"ant-scrolling-effect\");\r\n}"]}